---
title: http基础
category: http
tag: 网络
date: 2019/4/3
---

##### 什么是 http?

> htpp 是一种网络资源传输协议，它规定了数据传输格式，简称“超文本传输协议”。
> htpp 是可靠的，不会发生数据丢包或者发生传输顺序错误（按序传输）,因为 http 是基于 TCP/IP 上层的应用层协议，tcp 采用三次握手和四次挥手保证数据的传输的完整性和有序性。
> htpp 协议是无状态的，因为客户端与服务器采用一次请求一次应答的方式，服务器处理完请求就关闭连接。
> http 是一种灵活的协议。可以传输任意类型的数据，只需在请求头字段*Content-Type*中指定文件的 MIME 类型。

##### http 协议组成部分

> 1. 请求报文
>
> -   请求行：包含请求方法、URI、HTTP 版本信息
> -   请求头
> -   请求体
>
> 2. 响应报文
>
> -   响应行：包含 HTTP 版本、状态码、状态码的原因短语
> -   响应头
> -   响应体

![http报文结构](/images/http/http基础/1.png)

> http 报文是由一行一行的字符串组成，都是纯文本不是二进制，方便对其进行读写。

> **请求报文** > \<method\> \<request-url\> \<version\> > \<headers\> > \<entity-body\>

> **响应报文** > \<version\> \<status\> \<reason-phrase\> > \<headers\> > \<entity-body\>

**解释**

> -   method(请求方法)
>     > 客户端希望服务器对资源执行的动作，比如 GET,POST 或者 PUT 等
> -   request-url(请求 url)
>     > 请求资源在服务器上的地址。
> -   version(协议版本)
>     > 当前使用的 http 协议版本。
> -   status(状态码)
>     > 描述了请求过程中所发生的情况，每个状态码的第一位数字描述状态的一般类别(成功或出错)。
> -   reason-phrase(原因短语)
>     > 状态码的可读版本
> -   header(首部)
>     > 可以由零个或多个首部，每个首部都包含一个名字，后面跟着一个冒号(:)，然后是一个可选的空格，接着是一个值，最后是一个 CRLF。
> -   entity-body(实体)
>     > 实体的主体部分包含一个由任意数据组成的数据块，并不是所有的报文都包含实体部分，有时报文是以一个结束。

##### http 方法

> http 支持几种不同的请求命令，这些命令称为 HTTP 方法，每条 HTTP 请求报文都包含一个方法。这个方法告诉服务器要执行什么动作(获取一个 web 页面，运行一个网关程序，删除一个文件等)。

**常用方法**

| 方法名  | 描述                                                                                      |
| ------- | ----------------------------------------------------------------------------------------- |
| GET     | 通常用于请求服务器发送某个资源，一般用来查询数据                                          |
| HEAD    | 与 GET 响应类似，但服务器只返回响应头，不返回响应体；检查链接的有效性，检查网页是否被修改 |
| POST    | 用与向服务端发送数据的，比如提交表单                                                      |
| PUT     | 与 GET 从服务端读取文档相反，PUT 方法会向服务端写入文档                                   |
| DELETE  | 请求服务器删除 url 所指定的资源                                                           |
| OPTIONS | 一般用来请求服务器支持的各种功能，比如支持哪些方法，或者对某些特殊资源支持哪些方法        |

##### 状态码

> 每条 HTTP 响应报文返回时都会携带一个状态码。状态码是一个三位数的代码，服务器通过状态码来告诉客户端请求是否成功，或者是否需要执行其他的动作。

**状态码分类**

| 类别 | 作用             |
| ---- | ---------------- |
| 1xx  | 信息性状态码     |
| 2xx  | 成功状态码       |
| 3xx  | 重定向状态码     |
| 4xx  | 客户端错误状态码 |
| 5xx  | 服务器错误状态码 |

**常见状态码**

| 状态码  | 原因短语                      | 含义                                                                                                                                                                                                                                                         |
| ------- | ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 100     | Continue                      | 说明收到了请求的初始部分，请客户端继续。发送这个状态码，在服务端收到请求后必须响应                                                                                                                                                                           |
| 101     | Switching Protlcols           | 说明服务器正在根据客户端的指定，将协议切换成 Upgrade 首部所列的协议                                                                                                                                                                                          |
| 200     | OK                            | 请求成功，并且返回了所请求的资源                                                                                                                                                                                                                             |
| 201     | Created                       | 表示请求已被处理，并且创建了新资源。新的资源在应答返回之前已经被创建。同时新增的资源会在应答消息体中返回，其地址或者是原始请求的路径，或者是 Location 首部的值。                                                                                             |
| 202     | Accepted                      | 请求已被接受但尚未处理。不能保证服务器会完成这个请求，这只是意味着接受请求时，它看起来是有效的                                                                                                                                                               |
| 203     | Non-Authoritative Information | 表示请求已经被成功响应，但是获得的负载与源头服务器响应 200 的结果相比，经过了代理服务器的修改                                                                                                                                                                |
| 204     | No Content                    | 表示请求成功，但客户端不需要离开当前页面                                                                                                                                                                                                                     | 205 | Reset Content | 通知客户端重置文档视图，比如清空表单内容，重置 canvas 状态或者刷新当前页面 |
| 206     | Partial Content               | 表示请求已成功，并且主体包含所请求的数据区间，该数据区间是在请求的 Range 首部指定的。                                                                                                                                                                        |
| 300     | Multiple Choices              | 表示该请求有多种可能的响应，用户代理或者用户自身应该从中选择一个。由于没有如何进行选择的标准方法，这个状态码极少使用。                                                                                                                                       |
| **301** | Moved Permanently             | 永久重定向，说明请求的资源已经被移动到了由 Location 指定的 url 上，是固定的不会再改变。搜索引擎会根据该响应修正。                                                                                                                                            |
| **302** | Found                         | 临时重定向，表明请求的资源被暂时的移动到了由 Location 头部指定的 URL 上。浏览器会重定向到这个 URL， 但是搜索引擎不会对该资源的链接进行更新                                                                                                                   |
| 303     | See Other                     | 通常作为 PUT 或 POST 操作的返回结果，它表示重定向链接指向的不是新上传的资源，而是另外一个页面，比如消息确认页面或上传进度页面。而请求重定向页面的方法要总是使用 GET。                                                                                        |
| 304     | Not Modified                  | 表示无需再次传输请求的内容，也就说可以使用缓存的内容。这通常是在一些安全的方法，例如 GET 或 HEAD 或在请求中附带了头部信息： If-None-Match 或 If-Modified-Since。                                                                                             |
| 307     | Temporary Redirect            | 临时重定向，表示请求的资源暂时地被移动到了响应的 Location 首部所指向的 URL 上。                                                                                                                                                                              |
| 308     | Permanent Redirect            | 永久重定向，表示请求的资源已经被永久的移动到了由 Location 首部指定的 URL 上。浏览器会进行重定向，同时搜索引擎也会更新其链接 。在重定向过程中，请求方法和消息主体不会发生改变，然而在返回 301 状态码的情况下，请求方法有时候会被客户端错误地修改为 GET 方法。 |
| 400     | Bad Request                   | 表示由于语法无效，服务器无法理解该请求。 客户端不应该在未经修改的情况下重复此请求。                                                                                                                                                                          |
| 401     | Unauthorized                  | 代表客户端错误，指的是由于缺乏目标资源要求的身份验证凭证，发送的请求未得到满足。                                                                                                                                                                             |
| 402     | Payment Required              | 保留状态码                                                                                                                                                                                                                                                   |
| 403     | Forbidden                     | 服务器端有能力处理该请求，但是拒绝授权访问。 这个状态类似于 401，但进入该状态后不能再继续进行验证。该访问是长期禁止的，并且与应用逻辑密切相关（例如不正确的密码）。                                                                                          |
| **404** | Not Found                     | 请求的资源不存在                                                                                                                                                                                                                                             |
| **405** | Method Not Allowed            | 表明服务器禁止了使用当前 HTTP 方法的请求。需要注意的是，GET 与 HEAD 两个方法不得被禁止，当然也不得返回状态码 405。                                                                                                                                           |
| 406     | Not Acceptable                | 指代服务器端无法提供与 Accept-Charset 以及 Accept-Language 消息头指定的值相匹配的响应。                                                                                                                                                                      |
| 407     | Proxy Authentication Required | 指的是由于缺乏位于浏览器与可以访问所请求资源的服务器之间的代理服务器要求的身份验证凭证，发送的请求尚未得到满足。                                                                                                                                             |
| 408     | Request Timeout               | 表示服务器想要将没有在使用的连接关闭。一些服务器会在空闲连接上发送此信息，即便是在客户端没有发送任何请求的情况下。                                                                                                                                           |
| 409     | Conflict                      | 表示请求与服务器端目标资源的当前状态相冲，冲突最有可能发生在对 PUT 请求的响应中。例如，当上传文件的版本比服务器上已存在的要旧，从而导致版本冲突的时候，那么就有可能收到状态码为 409 的响应。突。                                                             |
| 410     | Gone                          | 说明请求的内容在服务器上不存在了，同时是永久性的丢失。如果不清楚是否为永久或临时的丢失，应该使用 404                                                                                                                                                         |
| 413     | Payload Too Large             | 表示请求主体的大小超过了服务器愿意或有能力处理的限度，服务器可能会（may）关闭连接以防止客户端继续发送该请求。                                                                                                                                                |
| 500     | Internal Server Error         | 所请求的服务器遇到意外的情况并阻止其执行请求。                                                                                                                                                                                                               |
| 501     | Not Implemented               | 表示请求的方法不被服务器支持，因此无法被处理。                                                                                                                                                                                                               |
| 502     | Bad Gateway                   | 表示作为网关或代理角色的服务器，从上游服务器（如 tomcat、php-fpm）中接收到的响应是无效的。                                                                                                                                                                   |
| 503     | Service Unavailable           | 表示服务器尚未处于可以接受请求的状态。通常造成这种情况的原因是由于服务器停机维护或者已超载。注意在发送该响应的时候，应该同时发送一个对用户友好的页面来解释问题发生的原因。                                                                                   |
| 504     | Gateway Timeout               | 表示扮演网关或者代理的服务器无法在规定的时间内获得想要的响应。                                                                                                                                                                                               |
| 505     | HTTP Version Not Supported    | 表示服务器不支持所请求的 http 版本                                                                                                                                                                                                                           |

**_302 与 307 的区别_**

> 状态码 307 与 302 之间的唯一区别在于，当发送重定向请求的时候，307 状态码可以确保请求方法和消息主体不会发生变化。如果使用 302 响应状态码，一些旧客户端会错误地将请求方法转换为 GET：也就是说，在 Web 中，如果使用了 GET 以外的请求方法，且返回了 302 状态码，则重定向后的请求方法是不可预测的；但如果使用 307 状态码，之后的请求方法就是可预测的。对于 GET 请求来说，两种情况没有区别。
